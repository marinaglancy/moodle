define(["jquery","core/ajax","core/templates","core/notification","core/str","core/config"],function(a,b,c,d,e,f){return a("body").on("click keypress","[data-editabletitle] [data-editabletitlelink]",function(e){if("keypress"!==e.type||13===e.keyCode){e.stopImmediatePropagation(),e.preventDefault();var g=a(this),h=a(g.closest("[data-editabletitle]").get(0)),i=a(h.find("input").get(0)),j=h.attr("data-identifier"),k=h.attr("data-callback"),l=function(e,f,g){var i=b.call([{methodname:"core_update_generic_title",args:{identifier:e,callback:f,value:g}}],!0);a.when.apply(a,i).done(function(b){c.render("core/editabletitle",b).done(function(b,d){c.replaceNode(h,b,d),a(h.find("[data-editabletitlelink]").get(0)).focus()})}).fail(d.exception)},m=function(){a("span.editabletitle.quickeditingon").each(function(){var b=a(this),c=a(b.find("input").get(0));c.off(),b.removeClass("quickeditingon"),c.val(b.attr("data-value"))})};m(),h.addClass("quickeditingon"),h.attr("data-value",i.val()),i.focus(),i.select(),i.on("keyup keypress focusout",function(a){f.behatsiterunning&&"focusout"===a.type||("keypress"===a.type&&13===a.keyCode&&(l(j,k,i.val()),m()),("keyup"===a.type&&27===a.keyCode||"focusout"===a.type)&&m())})}}),{}});