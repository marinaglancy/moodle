define(["jquery","core/ajax","core/notification","core/str","core/modal_factory","core/modal_events"],function(a,b,c,d,e,f){var g={VIEW_POLICY:'[data-action="view"]'},h=function(){this.registerEvents()};return h.prototype.registerEvents=function(){a(g.VIEW_POLICY).click(function(g){g.preventDefault();var h=a(this).data("versionid"),i=a(this).data("behalfid"),j={versionid:h,behalfid:i},k={methodname:"tool_policy_get_policy_version",args:j},l=b.call([k]),m="",n=e.types.CANCEL;a.when(l[0],d.get_string("policiesagreements","tool_policy")).then(function(a,b){return a.result?(m=b,a.result.policy.content):(c.addNotification({message:a.warnings[0].message,type:"error"}),!1)}).then(function(a){return e.create({title:m,body:a,type:n,large:!0}).then(function(a){return a.getRoot().on(f.hidden,function(){a.destroy()}),a})}).done(function(a){a.show()}).fail(c.exception)})},h});